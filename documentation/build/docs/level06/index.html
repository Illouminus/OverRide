<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-level06" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">🧪 Level 06 | Over Ride</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/docs/level06"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="🧪 Level 06 | Over Ride"><meta data-rh="true" name="description" content="&lt;MissionObjective"><meta data-rh="true" property="og:description" content="&lt;MissionObjective"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/docs/level06"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/level06" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/level06" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"🧪 Level 06","item":"https://your-docusaurus-site.example.com/docs/level06"}]}</script><link rel="stylesheet" href="/assets/css/styles.3349b886.css">
<script src="/assets/js/runtime~main.67a54dce.js" defer="defer"></script>
<script src="/assets/js/main.d9d2e099.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Over Ride Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Over Ride Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">EBAH</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">🛡️ OverRide Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level00">🧩 Level 00</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level01">🔐 Level 01</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level02">💣 Level 02</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level03">🔐 Level 03</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level04">🧼 Level 04</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level05">🧞‍♂️ Level 05</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/level06">🧪 Level 06</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level07">🧃 Level 07</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level08">🗂️ Level 08</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro_new">intro_new</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">🧪 Level 06</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>🧪 Level 06</h1></header>
<div class="missionCard_aJIf"><div class="missionHeader_ujCY"><span class="levelBadge_E6Y7">Level 06</span><h2 class="missionTitle_MLqA">Mission Objective</h2></div><div class="missionContent_AuQf"><p class="missionText_YjWt">Gain access to user <code class="targetCode_IWAs">level07 privileges</code> by exploiting <!-- -->Anti-debugging bypass and hash extraction<!-- -->.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vulnerability-analysis">Vulnerability Analysis<a href="#vulnerability-analysis" class="hash-link" aria-label="Direct link to Vulnerability Analysis" title="Direct link to Vulnerability Analysis">​</a></h2>
<div class="card_anxl"><div class="header_h_Kv"><h3 class="title_xshN">Anti-Debug Bypass &amp; Logic Exploitation</h3><span class="severityBadge_p8m1" style="background-color:#f59e0b20;color:#f59e0b;border-color:#f59e0b40">MEDIUM</span></div><p class="description_LGUH">Binary uses ptrace() anti-debugging protection and hash-based authentication. Instead of reversing the hash algorithm, we bypass ptrace and extract the computed hash directly from memory.</p><div class="techniques_SXJm"><h4 class="techniquesTitle_X_0j">Techniques</h4><div class="techniquesList_aLL1"><span class="techniqueTag_HgBs">Anti-Debug Bypass</span><span class="techniqueTag_HgBs">Memory Extraction</span><span class="techniqueTag_HgBs">GDB Jump Exploitation</span><span class="techniqueTag_HgBs">Hash Recovery</span></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="program-behavior-analysis">Program Behavior Analysis<a href="#program-behavior-analysis" class="hash-link" aria-label="Direct link to Program Behavior Analysis" title="Direct link to Program Behavior Analysis">​</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Binary Authentication Flow</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV">./level06</span></div><pre class="output_eCt5">-&gt; Enter Login: test
-&gt; Enter Serial: 123
Nope.</pre></div></div>
<p><strong>Authentication Logic:</strong></p>
<ol>
<li><strong>Input Validation</strong>: Login must be ≥6 chars, all printable</li>
<li><strong>Anti-Debug Check</strong>: <code>ptrace(PTRACE_TRACEME)</code> detects debugger</li>
<li><strong>Hash Calculation</strong>: Login string → integer hash</li>
<li><strong>Serial Comparison</strong>: Hash vs user-provided serial</li>
<li><strong>Shell Access</strong>: If match → <code>/bin/sh</code>, else exit</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="anti-debugging-protection">Anti-Debugging Protection<a href="#anti-debugging-protection" class="hash-link" aria-label="Direct link to Anti-Debugging Protection" title="Direct link to Anti-Debugging Protection">​</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Ptrace Detection Mechanism</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV">gdb ./level06</span></div><pre class="output_eCt5">(gdb) run
-&gt; Enter Login: test
-&gt; Enter Serial: 123
Starting program: /home/level06/level06 
New account detected
[Inferior 1 (process 1234) exited normally]</pre></div></div>
<p><strong>Protection Mechanism:</strong></p>
<ul>
<li><code>ptrace(PTRACE_TRACEME)</code> returns -1 if already being traced</li>
<li>Program detects GDB and exits with &quot;New account detected&quot;</li>
<li>Must bypass this check to analyze the hash algorithm</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="strategy-hash-extraction-without-reversing">Strategy: Hash Extraction Without Reversing<a href="#strategy-hash-extraction-without-reversing" class="hash-link" aria-label="Direct link to Strategy: Hash Extraction Without Reversing" title="Direct link to Strategy: Hash Extraction Without Reversing">​</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Exploitation Approach</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># Instead of reverse engineering hash algorithm</span></div><pre class="output_eCt5">1. Use GDB to bypass ptrace() check
2. Let program calculate hash naturally
3. Extract computed hash from memory
4. Use extracted hash as correct serial
5. Run program normally with correct credentials</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="live-demonstration">Live Demonstration<a href="#live-demonstration" class="hash-link" aria-label="Direct link to Live Demonstration" title="Direct link to Live Demonstration">​</a></h2>
<div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-by-step-exploitation">Step-by-Step Exploitation<a href="#step-by-step-exploitation" class="hash-link" aria-label="Direct link to Step-by-Step Exploitation" title="Direct link to Step-by-Step Exploitation">​</a></h2>
<div class="stepsContainer_pG2T"><div class="step_fonX"><div class="stepHeader_lANh"><span class="stepNumber_JMan">1</span><h3 class="stepTitle_pSoA">Setup GDB Breakpoints</h3></div><p class="stepDescription_I1sy">Place strategic breakpoints around ptrace and comparison</p><div class="codeBlock_MNNe"><div class="commandLine_KPva"><span class="prompt_hyWW">$</span><code class="command_dhjP">b *0x080487b5  # ptrace call
b *0x08048866  # hash comparison</code></div></div></div><div class="step_fonX"><div class="stepHeader_lANh"><span class="stepNumber_JMan">2</span><h3 class="stepTitle_pSoA">Initial Program Run</h3></div><p class="stepDescription_I1sy">Start program with any login/serial combination</p><div class="codeBlock_MNNe"><div class="commandLine_KPva"><span class="prompt_hyWW">$</span><code class="command_dhjP">run
Login: helloworld
Serial: 0</code></div></div></div><div class="step_fonX"><div class="stepHeader_lANh"><span class="stepNumber_JMan">3</span><h3 class="stepTitle_pSoA">Bypass Ptrace Check</h3></div><p class="stepDescription_I1sy">Jump over the ptrace call and its validation</p><div class="codeBlock_MNNe"><div class="commandLine_KPva"><span class="prompt_hyWW">$</span><code class="command_dhjP">jump *0x080487ed</code></div></div></div><div class="step_fonX"><div class="stepHeader_lANh"><span class="stepNumber_JMan">4</span><h3 class="stepTitle_pSoA">Extract Computed Hash</h3></div><p class="stepDescription_I1sy">Read hash value from stack at comparison point</p><div class="codeBlock_MNNe"><div class="commandLine_KPva"><span class="prompt_hyWW">$</span><code class="command_dhjP">p *(int*)($ebp - 0x10)</code></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="detailed-gdb-session">Detailed GDB Session<a href="#detailed-gdb-session" class="hash-link" aria-label="Direct link to Detailed GDB Session" title="Direct link to Detailed GDB Session">​</a></h3>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Complete GDB Bypass Session</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV">gdb ./level06</span></div><pre class="output_eCt5">(gdb) b *0x080487b5
Breakpoint 1 at 0x80487b5
(gdb) b *0x08048866  
Breakpoint 2 at 0x8048866
(gdb) run
Starting program: ./level06
-&gt; Enter Login: helloworld
-&gt; Enter Serial: 0

Breakpoint 1, 0x080487b5 in auth ()
(gdb) jump *0x080487ed
Continuing at 0x80487ed.

Breakpoint 2, 0x08048866 in auth ()
(gdb) p *(int*)($ebp - 0x10)
$1 = 106020184
(gdb) quit</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="assembly-analysis">Assembly Analysis<a href="#assembly-analysis" class="hash-link" aria-label="Direct link to Assembly Analysis" title="Direct link to Assembly Analysis">​</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Key Assembly Points</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV">(gdb) disas auth</span></div><pre class="output_eCt5">0x080487b5: call   0x80485f0 &lt;ptrace@plt&gt;    ; Anti-debug check
0x080487ba: test   %eax,%eax                    ; Check ptrace return
0x080487bc: jns    0x80487ed                    ; Jump if not traced
...
0x08048866: cmp    -0x10(%ebp),%eax            ; Compare hash with serial
0x08048869: je     0x8048872                    ; Jump if equal (success)</pre></div></div>
<p><strong>Critical Memory Layout:</strong></p>
<ul>
<li><code>%ebp - 0x10</code>: Computed hash storage location</li>
<li><code>%eax</code>: User-provided serial for comparison</li>
<li>Jump targets for bypass and success conditions</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="final-exploitation">Final Exploitation<a href="#final-exploitation" class="hash-link" aria-label="Direct link to Final Exploitation" title="Direct link to Final Exploitation">​</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Successful Authentication</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV">./level06</span></div><pre class="output_eCt5">-&gt; Enter Login: helloworld
-&gt; Enter Serial: 106020184
Authenticated!
$ whoami
level07
$ cat /home/users/level07/.pass
GbcPDRgsFK77LNnnuh7QyFYA2942Gp8yKj9KrWD8</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternative-hash-discovery">Alternative Hash Discovery<a href="#alternative-hash-discovery" class="hash-link" aria-label="Direct link to Alternative Hash Discovery" title="Direct link to Alternative Hash Discovery">​</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Quick Reference Commands</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># Complete exploit in one session</span></div><pre class="output_eCt5">gdb ./level06
(gdb) b *0x080487b5
(gdb) b *0x08048866
(gdb) run
# Login: helloworld, Serial: 0
(gdb) jump *0x080487ed
(gdb) p *(int*)($ebp - 0x10)
# Note the hash value
(gdb) quit
./level06
# Login: helloworld, Serial: &lt;extracted_hash&gt;</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-deep-dive">Technical Deep Dive<a href="#technical-deep-dive" class="hash-link" aria-label="Direct link to Technical Deep Dive" title="Direct link to Technical Deep Dive">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ptrace-anti-debug-analysis">Ptrace Anti-Debug Analysis<a href="#ptrace-anti-debug-analysis" class="hash-link" aria-label="Direct link to Ptrace Anti-Debug Analysis" title="Direct link to Ptrace Anti-Debug Analysis">​</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><strong>How Ptrace Protection Works</strong></div><div class="admonitionContent_BuS1"><ul>
<li><code>ptrace(PTRACE_TRACEME)</code> attaches process to its parent as debugger</li>
<li>Returns <code>-1</code> if process is already being traced (like by GDB)</li>
<li>Program checks return value and exits if debugging detected</li>
<li>Bypass: Jump over the ptrace call entirely</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hash-algorithm-insights">Hash Algorithm Insights<a href="#hash-algorithm-insights" class="hash-link" aria-label="Direct link to Hash Algorithm Insights" title="Direct link to Hash Algorithm Insights">​</a></h3>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Hash Function Characteristics</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># Different logins produce different hashes</span></div><pre class="output_eCt5">Login: &quot;hello&quot;     → Hash: 2134567890
Login: &quot;helloworld&quot; → Hash: 106020184
Login: &quot;admin&quot;      → Hash: 3456789012

Each login produces deterministic hash
Algorithm remains opaque but predictable</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="debugging-offset-discovery">Debugging Offset Discovery<a href="#debugging-offset-discovery" class="hash-link" aria-label="Direct link to Debugging Offset Discovery" title="Direct link to Debugging Offset Discovery">​</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Finding Key Assembly Offsets</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV">(gdb) disas auth</span></div><pre class="output_eCt5"># Look for these patterns:
call   &lt;ptrace@plt&gt;     ; Breakpoint 1 location
test   %eax,%eax        ; Ptrace return check
jns    &lt;address&gt;        ; Jump target for bypass
...
cmp    -0x10(%ebp),%eax ; Breakpoint 2 location</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-learning-points">Key Learning Points<a href="#key-learning-points" class="hash-link" aria-label="Direct link to Key Learning Points" title="Direct link to Key Learning Points">​</a></h2>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span><strong>Anti-Analysis Techniques</strong></div><div class="admonitionContent_BuS1"><ul>
<li><strong>Ptrace Detection</strong>: Common anti-debugging protection</li>
<li><strong>Dynamic Analysis Bypass</strong>: Jump instruction to skip checks</li>
<li><strong>Memory Inspection</strong>: Reading computed values without algorithm reversal</li>
<li><strong>Staged Exploitation</strong>: Use debugger info in normal execution</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternative-approaches">Alternative Approaches<a href="#alternative-approaches" class="hash-link" aria-label="Direct link to Alternative Approaches" title="Direct link to Alternative Approaches">​</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Other Potential Methods</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># If GDB bypass fails</span></div><pre class="output_eCt5">1. Binary patching: NOP out ptrace call
2. LD_PRELOAD: Hook ptrace to return success
3. Static analysis: Reverse hash algorithm completely
4. Timing attacks: Brute force with performance analysis</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-summary">Technical Summary<a href="#technical-summary" class="hash-link" aria-label="Direct link to Technical Summary" title="Direct link to Technical Summary">​</a></h2>
<p>This level demonstrates:</p>
<ol>
<li><strong>Anti-Debug Evasion</strong> - Bypassing ptrace protection mechanisms</li>
<li><strong>Dynamic Analysis Techniques</strong> - Using debuggers despite protection</li>
<li><strong>Memory Extraction</strong> - Reading computed values from stack</li>
<li><strong>Staged Attack Strategy</strong> - Combining debug info with normal execution</li>
<li><strong>Creative Problem Solving</strong> - Avoiding complex reverse engineering</li>
</ol>
<p>The vulnerability showcases how anti-debugging measures can be circumvented through careful debugger manipulation, and how sometimes the simplest approach (letting the program do the work) is more effective than complex reverse</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/level06.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/level05"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">🧞‍♂️ Level 05</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/level07"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">🧃 Level 07</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#vulnerability-analysis" class="table-of-contents__link toc-highlight">Vulnerability Analysis</a></li><li><a href="#program-behavior-analysis" class="table-of-contents__link toc-highlight">Program Behavior Analysis</a></li><li><a href="#anti-debugging-protection" class="table-of-contents__link toc-highlight">Anti-Debugging Protection</a></li><li><a href="#strategy-hash-extraction-without-reversing" class="table-of-contents__link toc-highlight">Strategy: Hash Extraction Without Reversing</a></li><li><a href="#live-demonstration" class="table-of-contents__link toc-highlight">Live Demonstration</a></li><li><a href="#step-by-step-exploitation" class="table-of-contents__link toc-highlight">Step-by-Step Exploitation</a><ul><li><a href="#detailed-gdb-session" class="table-of-contents__link toc-highlight">Detailed GDB Session</a></li></ul></li><li><a href="#assembly-analysis" class="table-of-contents__link toc-highlight">Assembly Analysis</a></li><li><a href="#final-exploitation" class="table-of-contents__link toc-highlight">Final Exploitation</a></li><li><a href="#alternative-hash-discovery" class="table-of-contents__link toc-highlight">Alternative Hash Discovery</a></li><li><a href="#technical-deep-dive" class="table-of-contents__link toc-highlight">Technical Deep Dive</a><ul><li><a href="#ptrace-anti-debug-analysis" class="table-of-contents__link toc-highlight">Ptrace Anti-Debug Analysis</a></li><li><a href="#hash-algorithm-insights" class="table-of-contents__link toc-highlight">Hash Algorithm Insights</a></li></ul></li><li><a href="#debugging-offset-discovery" class="table-of-contents__link toc-highlight">Debugging Offset Discovery</a></li><li><a href="#key-learning-points" class="table-of-contents__link toc-highlight">Key Learning Points</a></li><li><a href="#alternative-approaches" class="table-of-contents__link toc-highlight">Alternative Approaches</a></li><li><a href="#technical-summary" class="table-of-contents__link toc-highlight">Technical Summary</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Illouminus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Edouard Baillot<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/adrih1" target="_blank" rel="noopener noreferrer" class="footer__link-item">Adrien Hors<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>