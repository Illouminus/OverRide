"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[490],{3905:(e,n,s)=>{s.d(n,{A:()=>r});var i=s(6540),t=s(4848);const r=({src:e,id:n})=>{const s=(0,i.useRef)(null);return(0,i.useEffect)(()=>{const i=document.createElement("script");return i.src=e,i.id=n,i.async=!0,s.current&&s.current.appendChild(i),()=>{const e=document.getElementById(n);e&&e.remove()}},[e,n]),(0,t.jsx)("div",{ref:s})}},4700:(e,n,s)=>{s.d(n,{A:()=>p});var i=s(6540);const t="codeContainer_ZrQf",r="codeHeader_PMJ9",a="codeTitle_tp4q",l="copyButton_vymH",c="codeContent_hjih",o="commandSection_kIAe",d="prompt_g6zt",h="command_jQGV",m="output_eCt5";var u=s(4848);const p=({command:e,output:n,language:s="bash",title:p})=>{const[x,v]=(0,i.useState)(!1);return(0,u.jsxs)("div",{className:t,children:[p&&(0,u.jsxs)("div",{className:r,children:[(0,u.jsx)("span",{className:a,children:p}),(0,u.jsx)("button",{className:l,onClick:()=>{const s=e||n||"";navigator.clipboard.writeText(s),v(!0),setTimeout(()=>v(!1),2e3)},children:x?"\u2713":"Copy"})]}),(0,u.jsxs)("div",{className:c,children:[e&&(0,u.jsxs)("div",{className:o,children:[(0,u.jsx)("span",{className:d,children:"$"}),(0,u.jsx)("span",{className:h,children:e})]}),n&&(0,u.jsx)("pre",{className:m,children:n})]})]})}},6076:(e,n,s)=>{s.d(n,{A:()=>x});s(6540);const i="stepsContainer_pG2T",t="step_fonX",r="stepHeader_lANh",a="stepNumber_JMan",l="stepTitle_pSoA",c="stepDescription_I1sy",o="codeBlock_MNNe",d="commandLine_KPva",h="prompt_hyWW",m="command_dhjP",u="output_FTQu";var p=s(4848);const x=({steps:e})=>(0,p.jsx)("div",{className:i,children:e.map((e,n)=>(0,p.jsxs)("div",{className:t,children:[(0,p.jsxs)("div",{className:r,children:[(0,p.jsx)("span",{className:a,children:n+1}),(0,p.jsx)("h3",{className:l,children:e.title})]}),(0,p.jsx)("p",{className:c,children:e.description}),e.command&&(0,p.jsxs)("div",{className:o,children:[(0,p.jsxs)("div",{className:d,children:[(0,p.jsx)("span",{className:h,children:"$"}),(0,p.jsx)("code",{className:m,children:e.command})]}),e.output&&(0,p.jsx)("pre",{className:u,children:e.output})]})]},n))})},7916:(e,n,s)=>{s.d(n,{A:()=>h});s(6540);const i="missionCard_aJIf",t="missionHeader_ujCY",r="levelBadge_E6Y7",a="missionTitle_MLqA",l="missionContent_AuQf",c="missionText_YjWt",o="targetCode_IWAs";var d=s(4848);const h=({target:e,method:n,level:s})=>(0,d.jsxs)("div",{className:i,children:[(0,d.jsxs)("div",{className:t,children:[(0,d.jsx)("span",{className:r,children:s}),(0,d.jsx)("h2",{className:a,children:"Mission Objective"})]}),(0,d.jsx)("div",{className:l,children:(0,d.jsxs)("p",{className:c,children:["Gain access to user ",(0,d.jsx)("code",{className:o,children:e})," by exploiting ",n,"."]})})]})},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(6540);const t={},r=i.createContext(t);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:n},e.children)}},8620:(e,n,s)=>{s.d(n,{A:()=>u});s(6540);const i="card_anxl",t="header_h_Kv",r="title_xshN",a="severityBadge_p8m1",l="description_LGUH",c="techniques_SXJm",o="techniquesTitle_X_0j",d="techniquesList_aLL1",h="techniqueTag_HgBs";var m=s(4848);const u=({type:e,severity:n,description:s,techniques:u})=>{const p=e=>{switch(e){case"low":return"#22c55e";case"medium":return"#f59e0b";case"high":return"#f97316";case"critical":return"#ef4444";default:return"#6b7280"}};return(0,m.jsxs)("div",{className:i,children:[(0,m.jsxs)("div",{className:t,children:[(0,m.jsx)("h3",{className:r,children:e}),(0,m.jsx)("span",{className:a,style:{backgroundColor:`${p(n)}20`,color:p(n),borderColor:`${p(n)}40`},children:n.toUpperCase()})]}),(0,m.jsx)("p",{className:l,children:s}),(0,m.jsxs)("div",{className:c,children:[(0,m.jsx)("h4",{className:o,children:"Techniques"}),(0,m.jsx)("div",{className:d,children:u.map((e,n)=>(0,m.jsx)("span",{className:h,children:e},n))})]})]})}},8721:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>u,contentTitle:()=>m,default:()=>v,frontMatter:()=>h,metadata:()=>i,toc:()=>p});const i=JSON.parse('{"id":"level03","title":"\ud83d\udd10 Level 03","description":"<MissionObjective","source":"@site/docs/level03.md","sourceDirName":".","slug":"/level03","permalink":"/docs/level03","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/level03.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"\ud83d\udca3 Level 02","permalink":"/docs/level02"},"next":{"title":"\ud83e\uddfc Level 04","permalink":"/docs/level04"}}');var t=s(4848),r=s(8453),a=s(3905),l=s(7916),c=s(8620),o=s(4700),d=s(6076);const h={sidebar_position:5},m="\ud83d\udd10 Level 03",u={},p=[{value:"Vulnerability Analysis",id:"vulnerability-analysis",level:2},{value:"Initial Program Analysis",id:"initial-program-analysis",level:2},{value:"Binary Analysis with GDB",id:"binary-analysis-with-gdb",level:2},{value:"Test Function Analysis",id:"test-function-analysis",level:2},{value:"Decrypt Function Reverse Engineering",id:"decrypt-function-reverse-engineering",level:2},{value:"Live Demonstration",id:"live-demonstration",level:2},{value:"XOR Decryption Analysis",id:"xor-decryption-analysis",level:3},{value:"XOR Reversal Mathematics",id:"xor-reversal-mathematics",level:2},{value:"Final Exploitation",id:"final-exploitation",level:2},{value:"Key Learning Points",id:"key-learning-points",level:2},{value:"Technical Summary",id:"technical-summary",level:2}];function x(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"-level-03",children:"\ud83d\udd10 Level 03"})}),"\n",(0,t.jsx)(l.A,{level:"Level 03",target:"level04 shell access",method:"XOR decryption and reverse engineering"}),"\n",(0,t.jsx)(n.h2,{id:"vulnerability-analysis",children:"Vulnerability Analysis"}),"\n",(0,t.jsx)(c.A,{type:"Weak Cryptography & Logic Flaw",severity:"medium",description:"The binary uses simple XOR encryption with a predictable key derived from user input. The decryption logic can be reversed through static analysis to find the correct password.",techniques:["Static Analysis","XOR Reversal","Assembly Inspection"]}),"\n",(0,t.jsx)(n.h2,{id:"initial-program-analysis",children:"Initial Program Analysis"}),"\n",(0,t.jsx)(o.A,{title:"Program Execution",command:"./level03",output:"***********************************\n*           level03              **\n***********************************\nPassword:\n[Enter anything]\nInvalid Password"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key Observations:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Program expects a numeric password"}),"\n",(0,t.jsx)(n.li,{children:'Shows "Invalid Password" for wrong input'}),"\n",(0,t.jsx)(n.li,{children:"No obvious brute-force opportunity"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"binary-analysis-with-gdb",children:"Binary Analysis with GDB"}),"\n",(0,t.jsx)(o.A,{title:"Main Function Disassembly",command:"gdb ./level03",output:'(gdb) disas main\n...\nmovl $0x8048a7b, %eax        ; printf("Password:")\nscanf("%d", &input)          ; user input -> [esp+0x1c]\nmovl $322424845, 0x4(%esp)   ; hardcoded constant\nmov input, (%esp)\ncall test                    ; test(input, 322424845)\n...'}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key Findings:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Program calls ",(0,t.jsx)(n.code,{children:"test(input, 322424845)"})," with user input and hardcoded constant"]}),"\n",(0,t.jsxs)(n.li,{children:["The magic number ",(0,t.jsx)(n.code,{children:"322424845"})," is crucial for the algorithm"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"test-function-analysis",children:"Test Function Analysis"}),"\n",(0,t.jsx)(o.A,{title:"Test Function Logic",command:"(gdb) disas test",output:"mov param2, %eax        ; eax = 322424845\nsub param1, %eax        ; eax = 322424845 - input\ncmp eax, 21             ; if difference <= 21, continue\n...\ncall decrypt            ; decrypt(322424845 - input)"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Algorithm Logic:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:"delta = 322424845 - input\nif (delta <= 21) {\n    decrypt(delta);\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This means our input must be in range: ",(0,t.jsx)(n.code,{children:"322424824"})," to ",(0,t.jsx)(n.code,{children:"322424845"})]}),"\n",(0,t.jsx)(n.h2,{id:"decrypt-function-reverse-engineering",children:"Decrypt Function Reverse Engineering"}),"\n",(0,t.jsx)(o.A,{title:"Encrypted Data in Memory",command:"(gdb) disas decrypt",output:"movl $0x757c7d51,-0x1d(%ebp)   ; Encrypted bytes\nmovl $0x67667360,-0x19(%ebp)\nmovl $0x7b66737e,-0x15(%ebp)\nmovl $0x33617c7d,-0x11(%ebp)"}),"\n",(0,t.jsx)(n.h2,{id:"live-demonstration",children:"Live Demonstration"}),"\n",(0,t.jsx)(a.A,{src:"https://asciinema.org/a/blO98TyOPnHSV469YafAMkCjy.js",id:"asciicast-blO98TyOPnHSV469YafAMkCjy"}),"\n",(0,t.jsx)(n.h3,{id:"xor-decryption-analysis",children:"XOR Decryption Analysis"}),"\n",(0,t.jsx)(d.A,{title:"Reversing the XOR Encryption",steps:[{title:"Extract Encrypted Bytes",description:"Convert little-endian hex values to string",command:"echo -n 517d7c75 60736667 7e73667b 7d7c6133 | xxd -r -p",result:"Q}|u`sfg~sf{}|a3"},{title:"Identify Target String",description:"The program compares decrypted result to known string",command:"# Target string from binary analysis",result:"Congratulations!"},{title:"Calculate XOR Key",description:"Find what XOR key transforms encrypted to target",command:"# First character: 'Q' ^ x = 'C'",result:"x = 'Q' ^ 'C' = 0x51 ^ 0x43 = 0x12 (18)"},{title:"Solve for Input",description:"Work backwards from XOR key to input",command:"# 322424845 - input = 18",result:"input = 322424827"}]}),"\n",(0,t.jsx)(n.h2,{id:"xor-reversal-mathematics",children:"XOR Reversal Mathematics"}),"\n",(0,t.jsx)(o.A,{title:"XOR Key Calculation",command:"# Manual XOR reversal",output:"Encrypted: Q}|u`sfg~sf{}|a3\nTarget:    Congratulations!\n\nFirst char: 'Q' (0x51) ^ key = 'C' (0x43)\nKey = 0x51 ^ 0x43 = 0x12 = 18\n\nVerification with other characters:\n'}' (0x7D) ^ 18 = 'o' \u2713\n'|' (0x7C) ^ 18 = 'n' \u2713\n'u' (0x75) ^ 18 = 'g' \u2713"}),"\n",(0,t.jsx)(n.h2,{id:"final-exploitation",children:"Final Exploitation"}),"\n",(0,t.jsx)(o.A,{title:"Successful Password Entry",command:"./level03",output:"***********************************\n*           level03              **\n***********************************\nPassword: 322424827\n$ whoami\nlevel04\n$ cat /home/users/level04/.pass\n[REDACTED]"}),"\n",(0,t.jsx)(n.h2,{id:"key-learning-points",children:"Key Learning Points"}),"\n",(0,t.jsxs)(n.admonition,{type:"tip",children:[(0,t.jsx)(n.mdxAdmonitionTitle,{children:(0,t.jsx)(n.strong,{children:"Cryptographic Weaknesses"})}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Weak XOR Implementation"}),": Using a single-byte key makes the cipher trivial to break"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Predictable Key Derivation"}),": The XOR key is directly derived from user input"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Static Analysis Vulnerability"}),": All encryption constants are visible in the binary"]}),"\n"]})]}),"\n",(0,t.jsxs)(n.admonition,{type:"warning",children:[(0,t.jsx)(n.mdxAdmonitionTitle,{children:(0,t.jsx)(n.strong,{children:"Anti-Analysis Notes"})}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Program may fail when run through pipes or redirects due to stdin handling"}),"\n",(0,t.jsx)(n.li,{children:"Some anti-debugging measures may interfere with dynamic analysis"}),"\n",(0,t.jsx)(n.li,{children:"Manual input required - automated brute force approaches may not work"}),"\n"]})]}),"\n",(0,t.jsx)(n.h2,{id:"technical-summary",children:"Technical Summary"}),"\n",(0,t.jsx)(n.p,{children:"This level demonstrates:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Static Binary Analysis"})," - Extracting hardcoded constants and logic flow"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"XOR Cryptanalysis"})," - Reversing simple XOR encryption when plaintext is known"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Mathematical Problem Solving"})," - Working backwards from desired output to required input"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Assembly Code Reading"})," - Understanding x86 instructions and function calling conventions"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The vulnerability lies in using a weak XOR cipher with a user-controlled key, combined with the ability to reverse-engineer the"})]})}function v(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(x,{...e})}):x(e)}}}]);