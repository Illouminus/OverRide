"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[152],{3905:(e,s,i)=>{i.d(s,{A:()=>l});var n=i(6540),t=i(4848);const l=({src:e,id:s})=>{const i=(0,n.useRef)(null);return(0,n.useEffect)(()=>{const n=document.createElement("script");return n.src=e,n.id=s,n.async=!0,i.current&&i.current.appendChild(n),()=>{const e=document.getElementById(s);e&&e.remove()}},[e,s]),(0,t.jsx)("div",{ref:i})}},4420:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>m,contentTitle:()=>u,default:()=>x,frontMatter:()=>h,metadata:()=>n,toc:()=>p});const n=JSON.parse('{"id":"level00","title":"\ud83e\udde9 Level 00","description":"<MissionObjective","source":"@site/docs/level00.md","sourceDirName":".","slug":"/level00","permalink":"/docs/level00","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/level00.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"\ud83d\udee1\ufe0f OverRide Documentation","permalink":"/docs/intro"},"next":{"title":"\ud83d\udd10 Level 01","permalink":"/docs/level01"}}');var t=i(4848),l=i(8453),r=i(3905),a=i(7916),c=i(8620),o=i(4700),d=i(6076);const h={sidebar_position:2},u="\ud83e\udde9 Level 00",m={},p=[{value:"Vulnerability Analysis",id:"vulnerability-analysis",level:2},{value:"Reconnaissance",id:"reconnaissance",level:2},{value:"Binary Analysis",id:"binary-analysis",level:2},{value:"Reverse Engineering with GDB",id:"reverse-engineering-with-gdb",level:2},{value:"Live Demonstration",id:"live-demonstration",level:2},{value:"Step-by-Step Solution",id:"step-by-step-solution",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2}];function v(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"-level-00",children:"\ud83e\udde9 Level 00"})}),"\n",(0,t.jsx)(a.A,{level:"Level 00",target:"level01 privileges",method:"Reverse engineering a setuid binary"}),"\n",(0,t.jsx)(s.h2,{id:"vulnerability-analysis",children:"Vulnerability Analysis"}),"\n",(0,t.jsx)(c.A,{type:"Weak Authentication & Privilege Escalation",severity:"high",description:"The binary uses a simple numeric comparison for authentication and calls system('/bin/sh') upon success. Combined with setuid permissions, this allows privilege escalation to the level01 user.",techniques:["GDB Analysis","Assembly Disassembly","SUID Exploitation"]}),"\n",(0,t.jsx)(s.h2,{id:"reconnaissance",children:"Reconnaissance"}),"\n",(0,t.jsx)(s.p,{children:"Let's start by gathering information about our target environment."}),"\n",(0,t.jsx)(o.A,{title:"File System Analysis",command:"ls -la",output:"total 17\ndr-xr-x---+ 1 level00 level00   120 Sep 10  2016 .\ndr-x--x--x  1 root    root      340 Sep 23  2015 ..\n-rw-r--r--  1 level00 level00   220 Sep 10  2016 .bash_logout\n-rw-r--r--  1 level00 level00  3489 Sep 10  2016 .bashrc\n-rw-r--r--  1 level00 level00   675 Sep 10  2016 .profile\n-rwsr-x---+ 1 level01 users    7280 Sep 10  2016 level00"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Key Observations:"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Found a setuid binary ",(0,t.jsx)(s.code,{children:"level00"})," owned by ",(0,t.jsx)(s.code,{children:"level01"})]}),"\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"s"})," bit indicates elevated privileges when executed"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"binary-analysis",children:"Binary Analysis"}),"\n",(0,t.jsx)(o.A,{title:"File Information",command:"file level00",output:"level00: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, for GNU/Linux 2.6.24, BuildID[sha1]=d2d5ca9c99d46f5b1f7a3c4c8542c9f6e4b9f2d5, not stripped"}),"\n",(0,t.jsx)(o.A,{title:"Permissions Check",command:"ls -l level00",output:"-rwsr-s---+ 1 level01 users 7280 Sep 10  2016 level00"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Key Observations:"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Binary is owned by ",(0,t.jsx)(s.code,{children:"level01"})," and has the setuid bit set"]}),"\n",(0,t.jsxs)(s.li,{children:["When executed, it runs with ",(0,t.jsx)(s.code,{children:"level01"})," privileges"]}),"\n",(0,t.jsx)(s.li,{children:"32-bit ELF binary, not stripped (good for analysis)"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"reverse-engineering-with-gdb",children:"Reverse Engineering with GDB"}),"\n",(0,t.jsx)(o.A,{title:"GDB Disassembly",command:"gdb level00",output:"(gdb) disas main\nDump of assembler code for function main:\n 0x08048494 <+0>:     push   %ebp\n 0x08048495 <+1>:     mov    %esp,%ebp\n ...\n 0x080484e7 <+83>:    cmp    $0x149c,%eax\n 0x080484ec <+88>:    jne    0x80484f8 <main+100>\n 0x080484ee <+90>:    movl   $0x80485e0,(%esp)\n 0x080484f5 <+97>:    call   0x8048390 <system@plt>\n ..."}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Critical Discovery:"})," The program compares input with ",(0,t.jsx)(s.code,{children:"0x149c"})," (5276 in decimal)!"]}),"\n",(0,t.jsx)(o.A,{title:"Convert Hex to Decimal",command:"python3 -c 'print(0x149c)'",output:"5276"}),"\n",(0,t.jsx)(s.h2,{id:"live-demonstration",children:"Live Demonstration"}),"\n",(0,t.jsx)(r.A,{src:"https://asciinema.org/a/bXLfMcqqNwKsw1SUErGhrgU3z.js",id:"asciicast-bXLfMcqqNwKsw1SUErGhrgU3z"}),"\n",(0,t.jsx)(s.h2,{id:"step-by-step-solution",children:"Step-by-Step Solution"}),"\n",(0,t.jsx)(d.A,{steps:[{title:"Launch the binary",description:"Execute the setuid binary to start the authentication process.",command:"./level00",output:"Password: "},{title:"Enter the discovered password",description:"Use the numeric password found through GDB analysis.",command:"5276",output:"Authenticated!\n$ "},{title:"Verify elevated privileges",description:"Check that we now have level01 effective privileges.",command:"whoami && id",output:"level00\nuid=1000(level00) gid=1000(level00) euid=1001(level01) egid=100(users)"},{title:"Access the password file",description:"Use full path to cat to ensure it runs with elevated privileges.",command:"/bin/cat /home/users/level01/.pass",output:"uvar42khalfholfkek"},{title:"Alternative: Get shell access",description:"The binary calls system('/bin/sh') which gives a shell with level01 privileges.",command:"# After entering 5276, you get a shell",output:"$ # Now you have level01 effective UID"}]}),"\n",(0,t.jsx)(s.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"GDB disassembly"})," reveals program logic and comparison values"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Setuid binaries"})," run with the owner's privileges (level01 in this case)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Simple numeric passwords"})," are easily discovered through reverse engineering"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"system() calls"})," in setuid programs can provide shell access with elevated privileges"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Full paths"})," to commands (like ",(0,t.jsx)(s.code,{children:"/bin/cat"}),") ensure proper privilege inheritance"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Tools used:"})," ",(0,t.jsx)(s.code,{children:"gdb"}),", ",(0,t.jsx)(s.code,{children:"file"}),", ",(0,t.jsx)(s.code,{children:"ls"}),", assembly analysis, privilege escalation"]}),"\n",(0,t.jsx)(s.admonition,{title:"Important Note",type:"warning",children:(0,t.jsxs)(s.p,{children:["Using ",(0,t.jsx)(s.code,{children:"cat"})," alone might fail because the real UID is still level00, while the effective UID is level01. The ",(0,t.jsx)(s.code,{children:".pass"})," file is only readable by level01. Using ",(0,t.jsx)(s.code,{children:"/bin/cat"})," with the full path ensures the command executes with the inherited effective UID."]})})]})}function x(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(v,{...e})}):v(e)}},4700:(e,s,i)=>{i.d(s,{A:()=>p});var n=i(6540);const t="codeContainer_ZrQf",l="codeHeader_PMJ9",r="codeTitle_tp4q",a="copyButton_vymH",c="codeContent_hjih",o="commandSection_kIAe",d="prompt_g6zt",h="command_jQGV",u="output_eCt5";var m=i(4848);const p=({command:e,output:s,language:i="bash",title:p})=>{const[v,x]=(0,n.useState)(!1);return(0,m.jsxs)("div",{className:t,children:[p&&(0,m.jsxs)("div",{className:l,children:[(0,m.jsx)("span",{className:r,children:p}),(0,m.jsx)("button",{className:a,onClick:()=>{const i=e||s||"";navigator.clipboard.writeText(i),x(!0),setTimeout(()=>x(!1),2e3)},children:v?"\u2713":"Copy"})]}),(0,m.jsxs)("div",{className:c,children:[e&&(0,m.jsxs)("div",{className:o,children:[(0,m.jsx)("span",{className:d,children:"$"}),(0,m.jsx)("span",{className:h,children:e})]}),s&&(0,m.jsx)("pre",{className:u,children:s})]})]})}},6076:(e,s,i)=>{i.d(s,{A:()=>v});i(6540);const n="stepsContainer_pG2T",t="step_fonX",l="stepHeader_lANh",r="stepNumber_JMan",a="stepTitle_pSoA",c="stepDescription_I1sy",o="codeBlock_MNNe",d="commandLine_KPva",h="prompt_hyWW",u="command_dhjP",m="output_FTQu";var p=i(4848);const v=({steps:e})=>(0,p.jsx)("div",{className:n,children:e.map((e,s)=>(0,p.jsxs)("div",{className:t,children:[(0,p.jsxs)("div",{className:l,children:[(0,p.jsx)("span",{className:r,children:s+1}),(0,p.jsx)("h3",{className:a,children:e.title})]}),(0,p.jsx)("p",{className:c,children:e.description}),e.command&&(0,p.jsxs)("div",{className:o,children:[(0,p.jsxs)("div",{className:d,children:[(0,p.jsx)("span",{className:h,children:"$"}),(0,p.jsx)("code",{className:u,children:e.command})]}),e.output&&(0,p.jsx)("pre",{className:m,children:e.output})]})]},s))})},7916:(e,s,i)=>{i.d(s,{A:()=>h});i(6540);const n="missionCard_aJIf",t="missionHeader_ujCY",l="levelBadge_E6Y7",r="missionTitle_MLqA",a="missionContent_AuQf",c="missionText_YjWt",o="targetCode_IWAs";var d=i(4848);const h=({target:e,method:s,level:i})=>(0,d.jsxs)("div",{className:n,children:[(0,d.jsxs)("div",{className:t,children:[(0,d.jsx)("span",{className:l,children:i}),(0,d.jsx)("h2",{className:r,children:"Mission Objective"})]}),(0,d.jsx)("div",{className:a,children:(0,d.jsxs)("p",{className:c,children:["Gain access to user ",(0,d.jsx)("code",{className:o,children:e})," by exploiting ",s,"."]})})]})},8453:(e,s,i)=>{i.d(s,{R:()=>r,x:()=>a});var n=i(6540);const t={},l=n.createContext(t);function r(e){const s=n.useContext(l);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),n.createElement(l.Provider,{value:s},e.children)}},8620:(e,s,i)=>{i.d(s,{A:()=>m});i(6540);const n="card_anxl",t="header_h_Kv",l="title_xshN",r="severityBadge_p8m1",a="description_LGUH",c="techniques_SXJm",o="techniquesTitle_X_0j",d="techniquesList_aLL1",h="techniqueTag_HgBs";var u=i(4848);const m=({type:e,severity:s,description:i,techniques:m})=>{const p=e=>{switch(e){case"low":return"#22c55e";case"medium":return"#f59e0b";case"high":return"#f97316";case"critical":return"#ef4444";default:return"#6b7280"}};return(0,u.jsxs)("div",{className:n,children:[(0,u.jsxs)("div",{className:t,children:[(0,u.jsx)("h3",{className:l,children:e}),(0,u.jsx)("span",{className:r,style:{backgroundColor:`${p(s)}20`,color:p(s),borderColor:`${p(s)}40`},children:s.toUpperCase()})]}),(0,u.jsx)("p",{className:a,children:i}),(0,u.jsxs)("div",{className:c,children:[(0,u.jsx)("h4",{className:o,children:"Techniques"}),(0,u.jsx)("div",{className:d,children:m.map((e,s)=>(0,u.jsx)("span",{className:h,children:e},s))})]})]})}}}]);